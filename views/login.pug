doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title Login - My Grocery Buddy
    link(rel="stylesheet", href="/css/style.css")
  
  body
    .auth-container
      .auth-card
        .auth-header
          h1 ðŸ›’ My Grocery Buddy
          p Welcome back! Login to your account
        
        //- Display backend messages
        if message
          .message(class=message.includes('âœ…') || message.toLowerCase().includes('success') ? 'success' : 'error')
            = message
        
        //- Success alert (hidden by default)
        #successAlert.message.success(style="display: none;")
          | âœ… Login successful! Redirecting...
        
        form#loginForm.auth-form(action="/login" method="POST")
          .form-group
            label(for="emailOrUsername") Email or Username
            input#emailOrUsername.form-input(
              type="text" 
              name="emailOrUsername" 
              placeholder="Enter email or username"
              required
            )
            .error-text#emailError
          
          .form-group
            label(for="password") Password
            input#password.form-input(
              type="password" 
              name="password" 
              placeholder="Enter password"
              required
            )
            .error-text#passwordError
          
          button.btn.btn-primary(type="submit") 
            span Login
        
        .auth-footer
          p Don't have an account? 
            a(href="/register") Register here

    script.
      const form = document.getElementById('loginForm');
      const emailInput = document.getElementById('emailOrUsername');
      const passwordInput = document.getElementById('password');
      const emailError = document.getElementById('emailError');
      const passwordError = document.getElementById('passwordError');
      const successAlert = document.getElementById('successAlert');

      form.addEventListener('submit', function(e) {
        let isValid = true;
        
        // Clear previous errors
        emailError.textContent = '';
        passwordError.textContent = '';
        emailInput.classList.remove('error');
        passwordInput.classList.remove('error');
        
        // Validate email/username
        if (emailInput.value.trim() === '') {
          emailError.textContent = 'Email or username is required';
          emailInput.classList.add('error');
          isValid = false;
          e.preventDefault();
        }
        
        // Validate password
        if (passwordInput.value.trim() === '') {
          passwordError.textContent = 'Password is required';
          passwordInput.classList.add('error');
          isValid = false;
          e.preventDefault();
        }
        
        // Show success alert if validation passes
        if (isValid) {
          e.preventDefault();
          successAlert.style.display = 'block';
          setTimeout(function() {
            form.submit();
          }, 800);
        }
      });
      
      // Remove error on input
      emailInput.addEventListener('input', function() {
        if (emailInput.value.trim() !== '') {
          emailError.textContent = '';
          emailInput.classList.remove('error');
        }
      });
      
      passwordInput.addEventListener('input', function() {
        if (passwordInput.value.trim() !== '') {
          passwordError.textContent = '';
          passwordInput.classList.remove('error');
        }
      });